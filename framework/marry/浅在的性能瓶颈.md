# 潜在的性能瓶颈

1. 合房时对于社交关系，保持合并，保持状态不变，例如：
  1. a关注b，a关注c，b和c结婚了，那么a的社交关系就变成了，a关注bc
  2. a关注b，a和c是好友，b和c结婚了，那么a的社交关系就变成了，a和bc是好友
  3. 那么以上情况对于b或c呢？
    1. 1情况，bc在一起了，bc的关系合并了，但是bc没有关注a，那么bc的社交关系就变成了，bc和a是陌生人
    1. 2情况，bc在一起了，bc的关系合并了，那么bc的社交关系就变成了，bc和a是好友
  1. 防止消耗过大的方法
    1. 给用户再增加一次筛选的功能 => 选择谁作为主体 => 额外展示需要合并的列表
      1. 查询另一半的社交关系，展示在前台页面，并让用户筛选，客户端返回要合并的主键（可选）
      2. 复制另一半的社交关系，插入到主体的社交关系
    

1. 分房时对于社交关系，采取直接虚拟删除的形式，不考虑复合，但是可能考虑后台恢复

# 资源系统

1. 现金除过送红包，送礼，提现，兑换金砖之外，不能在app内流通
2. 金砖，主要流通资源，除过提现，任何事都可以办
3. 能量砖，次要流通资源，只能送礼物，红包，购买部分房间样式

## 金砖问题

1. 有人从其他用户手中低价收购金砖，然后高价卖出，差价现金没有进到公司的口袋里，反而让其他人获利，那么公司的实际收益就降低了。
1. 用户购买低价黑金，本来这笔金砖，是只能通过充值获得的，但通过黑金就把这笔现金赚走了，不就是公司的实际收益降低了。
1. 如何解决呢？
    1. 只要主要货币可以非限制性的流通，那么必然会导致黑金问题，可以对货币流通加以限制，除过单向兑换之外，还可以
      1. 限制每日赠送额度
      2. 现金兑换金砖的比例（保稳，不要和黑金商打价格战）
      3. 定期减少金砖（赠送获得的金砖有消费时间限制，过了时间就失效）
      4. 额外消耗金砖的活动
      5. 奢侈品
      6. 直接干掉黑金商

## 现金问题

1. 现金会有相同的问题（都是宽泛流通导致的），但是现金可以1：1提现，就很少有人把现金卖黑金。
  1. 所以手续费不能高，若黑金商的买进比率，比官方提现比率高，就会有人把现金卖给黑金商，黑金再以接近1：1的比率卖出，量大之后同样能摧毁资源系统。


## 能量砖问题

1. 这种货币虽然不值钱，但是量大之后，亦有可能摧毁资源系统，处理方式同金砖。

